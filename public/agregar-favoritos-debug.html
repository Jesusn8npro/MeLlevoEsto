<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Favoritos - Agregar Productos de Prueba</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        .btn:hover {
            background: #1976D2;
        }
        .btn-danger {
            background: #f44336;
        }
        .btn-danger:hover {
            background: #d32f2f;
        }
        .btn-success {
            background: #4CAF50;
        }
        .btn-success:hover {
            background: #45a049;
        }
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Debug Favoritos - Agregar Productos de Prueba</h1>
        <p>Esta herramienta agrega productos de prueba con URLs de Google Drive para debuggear el problema de las im√°genes.</p>
        
        <div>
            <button onclick="agregarFavoritosConImagenes()" class="btn btn-success">
                ‚ûï Agregar Favoritos con Im√°genes de Google Drive
            </button>
            <button onclick="verFavoritos()" class="btn">
                üëÄ Ver Favoritos Actuales
            </button>
            <button onclick="limpiarFavoritos()" class="btn btn-danger">
                üóëÔ∏è Limpiar Favoritos
            </button>
            <button onclick="abrirPaginaFavoritos()" class="btn">
                üîó Abrir P√°gina de Favoritos
            </button>
        </div>
        
        <div id="status"></div>
        <div id="output"></div>
    </div>

    <script>
        function mostrarStatus(mensaje, tipo = 'success') {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${tipo}">${mensaje}</div>`;
        }

        function mostrarOutput(contenido) {
            const outputDiv = document.getElementById('output');
            outputDiv.innerHTML = `<pre>${contenido}</pre>`;
        }

        function agregarFavoritosConImagenes() {
            try {
                const favoritosConImagenes = [
                    {
                        id: Date.now().toString(),
                        producto_id: "test-1",
                        usuario_id: "temp-user",
                        fecha_agregado: new Date().toISOString(),
                        nombre: "RoverPack 3-en-1 - Producto de Prueba",
                        precio: 149000,
                        precio_oferta: 119000,
                        imagen: "https://drive.google.com/file/d/1YUGaBMl22HxCzNU6EMQcVf_E-WAiWoiA/view?usp=sharing",
                        slug: "roverpack-3-en-1-prueba",
                        fotos_principales: [
                            "https://drive.google.com/file/d/1YUGaBMl22HxCzNU6EMQcVf_E-WAiWoiA/view?usp=sharing",
                            "https://drive.google.com/file/d/1YUGaBMl22HxCzNU6EMQcVf_E-WAiWoiA/view?usp=sharing",
                            "https://drive.google.com/file/d/1YUGaBMl22HxCzNU6EMQcVf_E-WAiWoiA/view?usp=sharing"
                        ],
                        producto_imagenes: [
                            {
                                id: 1,
                                url: "https://drive.google.com/file/d/1YUGaBMl22HxCzNU6EMQcVf_E-WAiWoiA/view?usp=sharing",
                                alt: "Imagen principal"
                            }
                        ],
                        disponible: true
                    },
                    {
                        id: (Date.now() + 1).toString(),
                        producto_id: "test-2",
                        usuario_id: "temp-user",
                        fecha_agregado: new Date().toISOString(),
                        nombre: "Producto de Prueba 2",
                        precio: 89000,
                        precio_oferta: null,
                        imagen: "https://drive.google.com/file/d/1YUGaBMl22HxCzNU6EMQcVf_E-WAiWoiA/view?usp=sharing",
                        slug: "producto-prueba-2",
                        fotos_principales: [
                            "https://drive.google.com/file/d/1YUGaBMl22HxCzNU6EMQcVf_E-WAiWoiA/view?usp=sharing",
                            "https://drive.google.com/file/d/1YUGaBMl22HxCzNU6EMQcVf_E-WAiWoiA/view?usp=sharing"
                        ],
                        producto_imagenes: [
                            {
                                id: 2,
                                url: "https://drive.google.com/file/d/1YUGaBMl22HxCzNU6EMQcVf_E-WAiWoiA/view?usp=sharing",
                                alt: "Imagen principal producto 2"
                            }
                        ],
                        disponible: true
                    }
                ];

                // Obtener favoritos existentes
                const favoritosExistentes = JSON.parse(localStorage.getItem('favoritos') || '[]');
                
                // Agregar los nuevos favoritos
                const todosFavoritos = [...favoritosExistentes, ...favoritosConImagenes];
                
                // Guardar en localStorage
                localStorage.setItem('favoritos', JSON.stringify(todosFavoritos));
                
                mostrarStatus(`‚úÖ Se agregaron ${favoritosConImagenes.length} favoritos de prueba con im√°genes de Google Drive`, 'success');
                
                console.log('üîç Favoritos agregados:', favoritosConImagenes);
                
            } catch (error) {
                mostrarStatus(`‚ùå Error al agregar favoritos: ${error.message}`, 'error');
                console.error('Error:', error);
            }
        }

        function verFavoritos() {
            try {
                const favoritos = JSON.parse(localStorage.getItem('favoritos') || '[]');
                
                if (favoritos.length === 0) {
                    mostrarStatus('‚ÑπÔ∏è No hay favoritos guardados', 'info');
                    mostrarOutput('');
                    return;
                }

                mostrarStatus(`üìã Se encontraron ${favoritos.length} favoritos`, 'info');
                mostrarOutput(JSON.stringify(favoritos, null, 2));
                
            } catch (error) {
                mostrarStatus(`‚ùå Error al leer favoritos: ${error.message}`, 'error');
            }
        }

        function limpiarFavoritos() {
            try {
                localStorage.removeItem('favoritos');
                mostrarStatus('üóëÔ∏è Favoritos eliminados correctamente', 'success');
                mostrarOutput('');
            } catch (error) {
                mostrarStatus(`‚ùå Error al limpiar favoritos: ${error.message}`, 'error');
            }
        }

        function abrirPaginaFavoritos() {
            window.open('http://localhost:3001/favoritos', '_blank');
        }

        // Cargar favoritos al abrir la p√°gina
        window.onload = verFavoritos;
    </script>
</body>
</html>